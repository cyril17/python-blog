!function(o){function t(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return o[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var e={};return t.m=o,t.c=e,t.p="",t(0)}([function(o,t,e){"use strict";function n(o){var t=/^[A-Za-z][A-Za-z0-9_]{4,}$/;return t.test(o)}function r(o){var t=/^[\S]{6,}$/;return t.test(o)}function i(){return n(u.val())?r(d.val())?!0:(console.log("password invalid"),!1):(u.focus(),console.log("username invalid"),!1)}var a=e(1),c=e(2),s=window.location.protocol+"//"+window.location.host,l=s+"/api/v1.0/login",u=a("input#username"),d=a("input#password"),p=a("button#login-btn");a(function(){a.each([u,d],function(){a(this).keyup(function(){i()?p.prop("disabled",!1):p.prop("disabled",!0)})})}),a(document).ready(function(){setTimeout(function(){d.val("")},100)}),a(function(){p.on("click",function(){var o=u.val(),t=d.val();a.ajax({method:"POST",url:l,data:{username:o,password:t},dataType:"json",timeout:3e4,beforeSend:function(){p.prop("disabled",!0).text("登录中...")},error:function(){d.val(""),p.text("登录").prop("disabled",!0)},success:function(o){if(console.log(o),console.log(c.getUrlPara("redirect")),o.success&&1==o.success){p.text("登录成功");var t={plog_authenticator:"password_grant",access_token:o.access_token,expires_in:o.expires_in,expires_at:o.expires_at,refresh_token:o.refresh_token,token_type:o.token_type};localStorage.setItem("Plog:Token",JSON.stringify(t)),setTimeout(function(){var o=c.getUrlPara("redirect")?0==decodeURIComponent(c.getUrlPara("redirect")).indexOf("http")?decodeURIComponent(c.getUrlPara("redirect")):c.getSiteUrl()+decodeURIComponent(c.getUrlPara("redirect")):c.getSiteUrl();window.location.href=o},1500)}else d.val(""),p.text("登录").prop("disabled",!0),alert(o.message)}}).done(function(){p.text("登录")})})})},function(o,t){o.exports=jQuery},function(o,t,e){"use strict";var n=e(1);n(function(){n(".bind-redirect").on("click",function(o){o.preventDefault();var t=n(this).attr("href");t=t+"?redirect="+encodeURIComponent(window.location.pathname),window.location.href=t}),n("[data-focus]").on("focus",function(){n(n(this).data("focus")).slideDown()}).on("blur",function(){n(n(this).data("focus")).slideUp()})}),n(function(){n("a[data-toggle='dropdown']").on("click",function(){var o=n(this).data("toggle");n(this).closest("."+o).toggleClass("open")})}),t.getUrlPara=function(o,t){t||(t=window.location.href),o=o.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e="[\\?&]"+o+"=([^&#]*)",n=new RegExp(e),r=n.exec(t);return null==r?null:r[1]},t.getStoredAccessToken=function(){var o=localStorage.getItem("Plog:Token");return o=JSON.parse(o),o.access_token||""},t.getSiteUrl=function(){return window.location.protocol+"//"+window.location.host},t.getAPIUrl=function(){return window.location.protocol+"//"+window.location.host+"/api/v1.0"},t.getDashUrl=function(){return window.location.protocol+"//"+window.location.host+"/dashboard"}}]);